"use strict";var __awaiter=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,a){function i(e){try{s(o.next(e))}catch(e){a(e)}}function c(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}s((o=o.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){var n,o,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(exports,"__esModule",{value:!0}),function(){var e=!1,t=function(e){return e.returnValue="You have unsaved changes that may be lost.","You have unsaved changes that may be lost."},n=function(e){var t=document.createElement("div");t.className="modal is-active";var n=e.contextualColorName||"info",o=e.titleString||"",r=e.bodyHTML||"",a=e.cancelButtonHTML||"Cancel",i=e.okButtonHTML||"OK";t.innerHTML='<div class="modal-background"></div><div class="modal-content"><div class="message is-'+n+'"><header class="message-header"><span class="is-size-5"></span></header><section class="message-body">'+(""===r?"":'<div class="mb-4">'+r+"</div>")+'<div class="buttons is-block has-text-right">'+(e.hideCancelButton?"":'<button class="button is-cancel-button" type="button" aria-label="Cancel">'+a+"</button>")+'<button class="button is-ok-button is-'+n+'" type="button" aria-label="OK">'+i+"</button></div></section></div></div>",t.querySelector(".message-header").querySelector("span").innerText=o,e.hideCancelButton||t.querySelector(".is-cancel-button").addEventListener("click",function(){t.remove()});var c=t.querySelector(".is-ok-button");c.addEventListener("click",function(){t.remove(),e.callbackFn&&e.callbackFn()}),document.body.insertAdjacentElement("beforeend",t),c.focus()},o=document.querySelector("meta[name='csrf-token']"),r=o?o.getAttribute("content"):"",a={clearElement:function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},escapeHTML:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},dateToString:function(e){return e.getFullYear().toString()+"-"+("0"+(e.getMonth()+1).toString()).slice(-2)+"-"+("0"+e.getDate().toString()).slice(-2)},dateToTimeString:function(e){return("00"+e.getHours().toString()).slice(-2)+":"+("00"+e.getMinutes().toString()).slice(-2)},dateStringToDate:function(e){var t=e.split("-");return new Date(parseInt(t[0],10),parseInt(t[1],10)-1,parseInt(t[2],10))},dateStringDifferenceInDays:function(e,t){var n=a.dateStringToDate(e),o=a.dateStringToDate(t);return Math.round((o.getTime()-n.getTime())/864e5)},responseToJSON:function(e){return __awaiter(void 0,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,e.json()];case 1:return[2,t.sent()]}})})},postJSON:function(e,t,n){var o={credentials:"same-origin",headers:{"CSRF-Token":r},method:"POST"};if(t)if(t instanceof HTMLFormElement){var i=t;if(i.querySelector("input[name][type='file']"))o.body=new FormData(i);else{var c=new FormData(i),s={};c.forEach(function(e,t){Reflect.has(s,t)?(Array.isArray(s[t])||(s[t]=[s[t]]),s[t].push(e)):s[t]=e});var l=JSON.stringify(s);o.headers["Content-Type"]="application/json",o.body=l}}else t instanceof Object&&(o.headers["Content-Type"]="application/json",o.body=JSON.stringify(t));window.fetch(e,o).then(a.responseToJSON).then(n).catch(function(){a.alertModal("Error","Error communicating with the server.","OK","danger")})},showModal:function(e){e.classList.add("is-active")},hideModal:function(e){var t=e;t instanceof Event&&(t=e.currentTarget),(t.classList.contains("modal")?t:t.closest(".modal")).classList.remove("is-active")},htmlModalFolder:"/html/",openHtmlModal:function(e,t){window.fetch(a.htmlModalFolder+e+".html").then(function(e){return __awaiter(void 0,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,e.text()];case 1:return[2,t.sent()]}})})}).then(function(e){return __awaiter(void 0,void 0,void 0,function(){var n,o,r,a,i;return __generator(this,function(c){for((n=document.createElement("div")).innerHTML=e,o=n.querySelector(".modal"),document.body.insertAdjacentElement("beforeend",n),(null==t?void 0:t.onshow)&&t.onshow(o),o.classList.add("is-active"),r=function(){var e=o.classList.contains("is-active");if((null==t?void 0:t.onhide)&&e&&t.onhide(o))return;o.classList.remove("is-active"),(null==t?void 0:t.onhidden)&&e&&t.onhidden(o),n.remove(),(null==t?void 0:t.onremoved)&&t.onremoved()},(null==t?void 0:t.onshown)&&t.onshown(o,r),a=o.getElementsByClassName("is-close-modal-button"),i=0;i<a.length;i+=1)a[i].addEventListener("click",r);return[2]})})}).catch(function(){a.alertModal("Error","Error loading popup.","OK","danger")})},enableNavBlocker:function(){e||(window.addEventListener("beforeunload",t),e=!0)},disableNavBlocker:function(){e&&(window.removeEventListener("beforeunload",t),e=!1)},isNavBlockerEnabled:function(){return e},confirmModal:function(e,t,o,r,a){n({bodyHTML:t,callbackFn:a,contextualColorName:r,okButtonHTML:o,titleString:e})},alertModal:function(e,t,o,r){n({bodyHTML:t,contextualColorName:r,hideCancelButton:!0,okButtonHTML:o,titleString:e})}};window.cityssm=window.cityssm||a}();