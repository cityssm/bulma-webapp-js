"use strict";var __awaiter=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,a){function i(e){try{c(o.next(e))}catch(e){a(e)}}function l(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,l)}c((o=o.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){var n,o,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}};Object.defineProperty(exports,"__esModule",{value:!0}),function(){var e=!1,t=function(e){return e.returnValue="You have unsaved changes that may be lost.","You have unsaved changes that may be lost."},n=document.querySelector("meta[name='csrf-token']"),o=n?n.getAttribute("content"):"",r={clearElement:function(e){for(;e.firstChild;)e.firstChild.remove()},escapeHTML:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},dateToString:function(e){return e.getFullYear().toString()+"-"+("0"+(e.getMonth()+1).toString()).slice(-2)+"-"+("0"+e.getDate().toString()).slice(-2)},dateToTimeString:function(e){return("00"+e.getHours().toString()).slice(-2)+":"+("00"+e.getMinutes().toString()).slice(-2)},dateStringToDate:function(e){var t=e.split("-");return new Date(Number.parseInt(t[0],10),Number.parseInt(t[1],10)-1,Number.parseInt(t[2],10))},dateStringDifferenceInDays:function(e,t){var n=r.dateStringToDate(e),o=r.dateStringToDate(t);return Math.round((o.getTime()-n.getTime())/864e5)},responseToJSON:function(e){return __awaiter(void 0,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,e.json()];case 1:return[2,t.sent()]}})})},postJSON:function(e,t,n){var a={credentials:"same-origin",headers:{"CSRF-Token":o},method:"POST"};if(t)if(t instanceof HTMLFormElement){var i=t;if(i.querySelector("input[name][type='file']"))a.body=new FormData(i);else{var l=new FormData(i),c={};l.forEach(function(e,t){Reflect.has(c,t)?(Array.isArray(c[t])||(c[t]=[c[t]]),c[t].push(e)):c[t]=e});var s=JSON.stringify(c);a.headers["Content-Type"]="application/json",a.body=s}}else t instanceof Object&&(a.headers["Content-Type"]="application/json",a.body=JSON.stringify(t));window.fetch(e,a).then(r.responseToJSON).then(n).catch(function(){r.alertModal("Error","Error communicating with the server.","OK","danger")})},showModal:function(e){e.classList.add("is-active")},hideModal:function(e){var t=e;t instanceof Event&&(t=e.currentTarget),(t.classList.contains("modal")?t:t.closest(".modal")).classList.remove("is-active")},htmlModalFolder:"/html/",openHtmlModal:function(e,t){window.fetch(r.htmlModalFolder+e+".html").then(function(e){return __awaiter(void 0,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,e.text()];case 1:return[2,t.sent()]}})})}).then(function(e){return __awaiter(void 0,void 0,void 0,function(){var n,o,r,a,i,l;return __generator(this,function(c){for((n=document.createElement("div")).innerHTML=e,o=n.querySelector(".modal"),document.body.insertAdjacentElement("beforeend",n),(null==t?void 0:t.onshow)&&t.onshow(o),o.classList.add("is-active"),r=function(){var e=o.classList.contains("is-active");if((null==t?void 0:t.onhide)&&e&&t.onhide(o))return;o.classList.remove("is-active"),(null==t?void 0:t.onhidden)&&e&&t.onhidden(o),n.remove(),(null==t?void 0:t.onremoved)&&t.onremoved()},(null==t?void 0:t.onshown)&&t.onshown(o,r),a=o.querySelectorAll(".is-close-modal-button"),i=0,l=a;i<l.length;i++)l[i].addEventListener("click",r);return[2]})})}).catch(function(){r.alertModal("Error","Error loading popup.","OK","danger")})},enableNavBlocker:function(){e||(window.addEventListener("beforeunload",t),e=!0)},disableNavBlocker:function(){e&&(window.removeEventListener("beforeunload",t),e=!1)},isNavBlockerEnabled:function(){return e},confirmModal:function(e,t,n,o,r,a){bulmaJS.confirm({title:e,message:t,messageIsHtml:!0,contextualColorName:o,okButton:{text:n,textIsHtml:!0,callbackFunction:r}})},alertModal:function(e,t,n,o){bulmaJS.alert({title:e,message:t,messageIsHtml:!0,contextualColorName:o,okButton:{text:n,textIsHtml:!0}})}};window.cityssm=window.cityssm||r}();